import { History } from '../../components/history'

# Hooks

RainbowKit provides a variety of hooks that makes it easy to access data and perform actions within your dapp.

## useTxHistory

Manage your local dapp transactions.

```tsx
import React from 'react'
import { useTxHistory } from '@rainbow-me/kit-hooks'

const Index = () => {
  const { address, chainId, provider } = useWeb3State()
  const { txes, submit, reset } = useTxHistory({ provider, rememberHistory: true })

  return <TxHistory {...{ chainId, provider, txes, reset }} />
}
```

## useExplorerTxHistory

Fetch transaction history from a blokchain explorer (e.g. Etherscan) for an ethereum `address` with a given `provider` and `fetcher` function with any `options` needed.

```tsx
import React from 'react'
import { useExplorerTxHistory, useWeb3State } from '@rainbow-me/kit-hooks'
import { setupProvider, etherscanFetcher } from '@rainbow-me/kit-utils'
import { ChainProvider } from 'chain-provider'
import { formatEther } from '@ethersproject/units'

const provider = new EtherscanProvider()

const HistoryExample = () => {
  const { address } = useWeb3State()

  const {
    data: txes,
    loading,
    error
  } = useExplorerTxHistory({
    address: address || '0xD3B282e9880cDcB1142830731cD83f7ac0e1043f',
    fetcher: etherscanFetcher,
    provider
  })

  if (error) return <strong style={{ color: 'red' }}>Error! {error?.message}</strong>

  if (loading) return <p>Loading...</p>

  if (data && !loading)
    return (
      <>
        {txes.slice(0, 10).map((tx) => (
          <div key={tx.hash} style={{ fontFamily: 'monospace' }}>
            <a href={`https://etherscan.io/tx/${tx.hash}`}>{tx.hash.slice(0, 8)}</a>
            {' | '}
            <span>Value: {parseFloat(formatEther(tx.value)).toPrecision(3)} ETH</span>
          </div>
        ))}
      </>
    )
}
```

The optional `fetcher` function should follow the same form of the two provided fetcher functions.
`opts` can be whatever you want for the given fetcher.

```ts
type TxHistoryFetcher<Tx extends any = any, P extends Provider = Provider> = (opts: {
  address: string
  provider: P
  options?: any
}) => Promise<Tx[]>

const myFetcher = async ({ provider, address, options = {} }) => {
  return provider.whatever({ ...options })
}

const etherscanFetcher: TxHistoryFetcher<TransactionResponse, EtherscanProvider> = async ({
  provider,
  address,
  options = {}
}) => {
  return await provider.getHistory(address, options.fromBlock, options.toBlock)
}
```

<History />

## useConnector

A React hook for using individual connectors from web3-react. Pass a web3-react `connector` and a boolean indicating if web3-react should `connectOnMount` with the given connector. You can pass an optional `storageProvider` which defaults to `window.localStorage`.

```tsx
import { Connector, ConnectorProps } from 'my-custom-connector'
import { useConnector } from '@rainbow-me/kit-hooks'

export type CustomWalletOptions = ConnectorProps & { connectOnMount?: boolean }

export const useCustomConnector = (opts?: CustomWalletOptions) => {
  const options = opts || {}
  const { connectOnMount, ...customConnectorOpts } = options

  const connector = new Connector(customConnectorOpts)

  const { provider, connect, isConnected, disconnect, chainId, connector, address, error } = useConnector(
    connector,
    connectOnMount,
    window.localStorage
  )

  return {
    provider,
    connect,
    isConnected,
    disconnect,
    chainId,
    connector,
    address,
    error
  }
}
```

## useConnectOnMount

A React hook that attempts to reconnect to a provider to restore an already established connection.

```tsx
import { useState, useEffect } from 'react'
import { useWeb3React } from '@web3-react/core'
import { useConnectOnMount } from '@rainbow-me/kit-hooks'

const App = () => {
  const { library: provider, connector } = useWeb3React()

  const [storage, set] = useState<Storage>()

  useEffect(() => {
    set(sessionStorage)
  }, [])

  useConnectOnMount(connector, true, storage)

  return <h1>hello world</h1>
}
```
